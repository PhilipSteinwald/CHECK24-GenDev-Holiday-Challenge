{% load static from static %}
<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="author" content="Philip Steinwald">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Response Page</title>
    <link rel="shortcut icon" href="{% static 'icon.png'%}" type="image/x-icon" />
    <link rel="stylesheet" href="{% static 'styleResponse.css'%}">
</head>

<body>

    <div class="page-container">
        <div class="sidebar">
            <div class="sidebar-container">
                <form class="grid-container2" action="/response" method="get">
                    <label class="popupAirport" id="popupAirport" onclick="popupAirportFunc()">"Abflughafen"
                    </label>
                    <label class="popupPerson" id="popupPerson" onclick="popupPersonFunc()">1 Erw. 0 Kin.
                    </label>
                    <div class="days">
                        <label>Dauer: &nbsp;</label>
                        <input type="number" class="daysInput" id="quantity" name="quantity" min="1" required>
                        <label>Tage</label>
                    </div>
                    <div class="date1">
                        <input type="date" class="dateInput" id="firstDate" name="firstDate" placeholder="Hinflug" required>
                        <label>&nbsp; bis &nbsp;</label>
                    </div>
                    <input type="date" class="date2" id="secondDate" name="secondDate" placeholder="Rückflug" required>
                    <div class="next">
                        <input type="text" class="hidden-inputs" id="airports" name="airports" value="" required>
                        <input type="text" class="hidden-inputs" id="persons" name="persons" value="1 Erw. 0 Kin." required>
                        <input type="submit" class="submitInput" value="Reise finden">
                    </div>
                </form> 
            </div>
        </div>
        <div class="main">
            <h1>Hotels für Ihre Mallorca-Pauschalreise</h1><br>
            {% for offer in offer_list %}
            <div class="hotel-container"> 
                <img class="image-placeholder" src="{% static 'hotel.jpg'%}" alt="Hotel Image Placeholder">
                <div class="grid-container">
                    <div class="left">
                        <div class="name"> {{ offer.1.hotelname }} </div>
                        {% if offer.1.hotelstars == 1.0 %}
                            <div class="stars">&#9733;</div>
                        {% elif offer.1.hotelstars == 2.0 %}
                            <div class="stars">&#9733;&#9733;</div>
                        {% elif offer.1.hotelstars == 3.0 %}
                            <div class="stars">&#9733;&#9733;&#9733;</div>
                        {% elif offer.1.hotelstars == 4.0 %}
                            <div class="stars">&#9733;&#9733;&#9733;&#9733;</div>
                        {% elif offer.1.hotelstars == 5.0 %}
                            <div class="stars">&#9733;&#9733;&#9733;&#9733;&#9733;</div>
                        {% else %}
                            <div class="stars"></div>
                        {% endif %} 
                        {% if offer.0.roomtype == 'SINGLE' %}
                            <div class="room"> 1x Einzelzimmer </div>
                        {% elif offer.0.roomtype == 'DOUBLE' %}
                            <div class="room"> 1x Doppelzimmer </div>
                        {% elif offer.0.roomtype == 'FAMILY' %}
                            <div class="room"> 1x Familienzimmer </div>
                        {% elif offer.0.roomtype == 'APARTMENT' %}
                            <div class="room"> 1x Apartment </div>
                        {% elif offer.0.roomtype == 'STUDIO' %}
                            <div class="room"> 1x Studio </div>
                        {% elif offer.0.roomtype == 'SUITE' %}
                            <div class="room"> 1x Suite </div>
                        {% elif offer.0.roomtype == 'ACCORDINGDESCRIPTION' %}
                            <div class="room"> 1x Zimmer </div>
                        {% else %}
                            <div class="room"> 1x{{ offer.0.roomtype }} </div>
                        {% endif %}
                        {% if offer.0.mealtype == 'NONE' %}
                            <div class="mealtype"> Keine Verpflegung </div>
                        {% elif offer.0.mealtype == 'BREAKFAST' %}
                            <div class="mealtype"> Frühstück </div>
                        {% elif offer.0.mealtype == 'HALFBOARD' %}
                            <div class="mealtype"> Halbpension </div>
                        {% elif offer.0.mealtype == 'ALLINCLUSIVE' %}
                            <div class="mealtype"> Alles Inklusive </div>
                        {% else %}
                            <div class="mealtype"> {{ offer.0.mealtype }} </div>
                        {% endif %} 
                    </div>
                    <form class="right" action="/result" method="get">
                        <input type="text" class="hidden-inputs" name="hotelID" value={{offer.1.hotelid}} required>
                        <input type="text" class="hidden-inputs" name="days" value={{days}} required>
                        <input type="text" class="hidden-inputs" name="firstDate" value={{firstDate}} required>
                        <input type="text" class="hidden-inputs" name="secondDate" value={{secondDate}} required>
                        <input type="text" class="hidden-inputs" name="airports" value={{airports}} required>
                        <input type="text" class="hidden-inputs" name="persons" value={{persons}} required>
                        <div class="price">Preis: {{ offer.0.price }}€</div>
                        <input type="submit" class="hotel-button" value="zu den Angeboten">
                    </form>
                </div>
            </div><br>
            {% endfor %}
        </div>
    </div>

    <div class="popupPerson-container" id="myPersonPopup">
        <input type="button" class="parent-minus" onclick="decrementParentValue()" value="-" />
        <input type="text" id="parent-number" class="parent-number" value="1" readonly/>
        <input type="button" class="parent-plus" onclick="incrementParentValue()" value="+" />
        <label class="parents">Erwachsene</label>
        <input type="button" class="children-minus" onclick="decrementChildrenValue()" value="-" />
        <input type="text" id="children-number" class="children-number" value="0" readonly/>
        <input type="button" class="children-plus" onclick="incrementChildrenValue()" value="+" />
        <label class="children">Kinder</label>
        <input type="button" class="popup-button" onclick="safePopup()" value="Übernehmen"/>
    </div>

    <div class="popupAirport-button" id="myAirportPopupBottom" style="visibility: hidden;">
        <input type="button" style="width: 255px; height: 30px;" onclick="popupAirportFunc()" value="Übernehmen"/>
    </div>

    <div class="popupAirport-container" id="myAirportPopupTop" style="visibility: hidden;">
        <input type="checkbox" onclick="tickBox('FRA')"/>
        <label>Frankfurt(FRA)</label><br>
        <input type="checkbox" onclick="tickBox('MUC')"/>
        <label>München(MUC)</label><br>
        <input type="checkbox" onclick="tickBox('BER')"/>
        <label>Berlin(BER)</label><br>
        <input type="checkbox" onclick="tickBox('LEJ')"/>
        <label>Leipzig(LEJ)</label><br>
        <input type="checkbox" onclick="tickBox('DUS')"/>
        <label>Düsseldorf(DUS)</label><br>
        <input type="checkbox" onclick="tickBox('HAM')"/>
        <label>Hamburg(HAM)</label><br>
        <input type="checkbox" onclick="tickBox('VIE')"/>
        <label>Wien(VIE)</label><br>
        <input type="checkbox" onclick="tickBox('NUE')"/>
        <label>Nürnberg(NUE)</label><br>
        <input type="checkbox" onclick="tickBox('SCN')"/>
        <label>Saarbrücken(SCN)</label><br>
        <input type="checkbox" onclick="tickBox('STR')"/>
        <label>Stuttgart(STR)</label><br>
        <input type="checkbox" onclick="tickBox('HAJ')"/>
        <label>Hannover(HAJ)</label><br>
        <input type="checkbox" onclick="tickBox('BSL')"/>
        <label>Basel(BSL)</label><br>
        <input type="checkbox" onclick="tickBox('FDH')"/>
        <label>Friedrichshafen(FDH)</label><br>
        <input type="checkbox" onclick="tickBox('FMO')"/>
        <label>Münster/Osnabrück(FMO)</label><br>
        <input type="checkbox" onclick="tickBox('CGN')"/>
        <label>Köln/Bonn(CGN)</label><br>
        <input type="checkbox" onclick="tickBox('PAD')"/>
        <label>Paderborn(PAD)</label><br>
        <input type="checkbox" onclick="tickBox('FMM')"/>
        <label>Memmingen(FMM)</label><br>
        <input type="checkbox" onclick="tickBox('DRS')"/>
        <label>Dresden(DRS)</label><br>
        <input type="checkbox" onclick="tickBox('BRE')"/>
        <label>Bremen(BRE)</label><br>
        <input type="checkbox" onclick="tickBox('DTM')"/>
        <label>Dortmund(DTM)</label><br>
        <input type="checkbox" onclick="tickBox('NRN')"/>
        <label>Niederrhein(NRN)</label><br>
        <input type="checkbox" onclick="tickBox('HHN')"/>
        <label>Frankfurt-Hain(HHN)</label><br>
        <input type="checkbox" onclick="tickBox('FKB')"/>
        <label>Karlsruhe/Baden-Baden(FKB)</label><br>
        <input type="checkbox" onclick="tickBox('ZRH')"/>
        <label>Zürich(ZRH)</label><br>
        <input type="checkbox" onclick="tickBox('SZG')"/>
        <label>Salzburg(SZG)</label><br>
        <input type="checkbox" onclick="tickBox('LUX')"/>
        <label>Luxemburg(LUX)</label><br>
        <input type="checkbox" onclick="tickBox('AMS')"/>
        <label>Amsterdam(AMS)</label><br>
        <input type="checkbox" onclick="tickBox('PRG')"/>
        <label>Prag(PRG)</label><br>
        <input type="checkbox" onclick="tickBox('INN')"/>
        <label>Innsbruck(INN)</label><br>
        <input type="checkbox" onclick="tickBox('KSF')"/>
        <label>Kassel(KSF)</label><br>
        <input type="checkbox" onclick="tickBox('LNZ')"/>
        <label>Linz(LNZ)</label><br>
        <input type="checkbox" onclick="tickBox('EIN')"/>
        <label>Eindhoven(EIN)</label><br>
        <input type="checkbox" onclick="tickBox('SXB')"/>
        <label>Straßburg(SXB)</label><br>
        <input type="checkbox" onclick="tickBox('BLL')"/>
        <label>Billund(BLL)</label><br>
        <input type="checkbox" onclick="tickBox('LBC')"/>
        <label>Lübeck(LBC)</label><br>
        <input type="checkbox" onclick="tickBox('BRU')"/>
        <label>Brüssel(BRU)</label><br>
        <input type="checkbox" onclick="tickBox('GRZ')"/>
        <label>Graz(GRZ)</label><br>
        <input type="checkbox" onclick="tickBox('GWT')"/>
        <label>Sylt(GWT)</label><br>
        <input type="checkbox" onclick="tickBox('CRL')"/>
        <label>Brüssel-Süd(CRL)</label><br>
        <input type="checkbox" onclick="tickBox('CSO')"/>
        <label>Madgeburg(CSO)</label><br>
        <input type="checkbox" onclick="tickBox('WAW')"/>
        <label>Warschau(WAW)</label><br>
        <input type="checkbox" onclick="tickBox('GVA')"/>
        <label>Genf(GVA)</label><br>
        <input type="checkbox" onclick="tickBox('ERF')"/>
        <label>Erfurt-Weimar(ERF)</label><br>
        <input type="checkbox" onclick="tickBox('KRK')"/>
        <label>Krakau(KRK)</label><br>
        <input type="checkbox" onclick="tickBox('BRN')"/>
        <label>Bern(BRN)</label><br>
        <input type="checkbox" onclick="tickBox('RLG')"/>
        <label>Rostock(RLG)</label><br>
        <input type="checkbox" onclick="tickBox('KLU')"/>
        <label>Klagenfurt(KLU)</label><br>
        <input type="checkbox" onclick="tickBox('RTM')"/>
        <label>Rotterdam/Den Haag(RTM)</label><br>
    </div>

    <script>
    //functions to make the popups visible and to position them
    function popupPersonFunc() {
        var popup = document.getElementById("myPersonPopup");
        var popupOrigin = document.getElementById("popupPerson");
        var rect = popupOrigin.getBoundingClientRect();
        popup.style.top = (rect.top + 38)  + 'px';
        if(rect.left - 50 < 5){
            popup.style.left = '5px';
        }else {
            popup.style.left = (rect.left - 50) + 'px';
        }
        popup.classList.toggle("show");
    }

    function popupAirportFunc() {
        var popup1 = document.getElementById("myAirportPopupTop");
        var popup2 = document.getElementById("myAirportPopupBottom");
        var popupOrigin = document.getElementById("popupAirport");
        var rect = popupOrigin.getBoundingClientRect();
        popup1.style.top = (rect.top + 38) + 'px';
        popup2.style.top = (rect.top + 138) + 'px';
        if(rect.left - 40 < 5){
            popup1.style.left = '5px';
            popup2.style.left = '5px';
        }else {
            popup1.style.left = (rect.left - 40) + 'px';
            popup2.style.left = (rect.left - 40) + 'px';
        }
        if(popup1.style.visibility == 'hidden') {
            popup1.style.visibility = 'visible';
            popup2.style.visibility = 'visible';
        }else {
            popup1.style.visibility = 'hidden';
            popup2.style.visibility = 'hidden';
        }
    }


    //functions to increment/decrement the value for the number of children/parents
    function decrementParentValue() {
        var valueC = parseInt(document.getElementById('children-number').value, 10);
        var valueP = parseInt(document.getElementById('parent-number').value, 10);
        //check to ensure that at least one person is selected
        value = (isNaN(valueC) ? 0 : valueC) + (isNaN(valueP) ? 0 : valueP);
        if(value > 1 && valueP > 0){
            valueP--;
        }
        document.getElementById('parent-number').value = valueP;
    }

    function incrementParentValue() {
        var value = parseInt(document.getElementById('parent-number').value, 10);
        value = isNaN(value) ? 0 : value;
        value++;
        document.getElementById('parent-number').value = value;
    }

    function decrementChildrenValue() {
        var valueC = parseInt(document.getElementById('children-number').value, 10);
        var valueP = parseInt(document.getElementById('parent-number').value, 10);
        //check to ensure that at least one person is selected
        value = (isNaN(valueC) ? 0 : valueC) + (isNaN(valueP) ? 0 : valueP);
        if(value > 1 && valueC > 0){
            valueC--;
        }
        document.getElementById('children-number').value = valueC;
    }

    function incrementChildrenValue() {
        var value = parseInt(document.getElementById('children-number').value, 10);
        value = isNaN(value) ? 0 : value;
        value++;
        document.getElementById('children-number').value = value;
    }


    //function to safe the values in the following format: xErw.xKin.
    function safePopup() {
        var value1 = parseInt(document.getElementById('parent-number').value, 10);
        var value2 = parseInt(document.getElementById('children-number').value, 10);
        document.getElementById('popupPerson').innerHTML = value1 + ' Erw. ' + value2 + ' Kin.';
        document.getElementById('persons').value = value1 + ' Erw. ' + value2 + ' Kin.';
        popupPersonFunc();
    }


    //function to update the selected airports
    function tickBox(ita) {
        var popup = document.getElementById("popupAirport");
        //check whether no airport is selected at the moment
        if(popup.innerHTML.includes("Abflughafen")) {
            popup.innerHTML = ita;
            document.getElementById('airports').value = ita;
        }else {
            //check whether the airport is already selected or not
            if(popup.innerHTML.includes(ita)){
                //updates the displayed list of selected airports to remove the airport
                var ita_list = popup.innerHTML.split(', ');
                var result = '';
                for(var i=0;i<ita_list.length;i++){
                    if(!ita_list[i].includes(ita)){
                        if(ita_list[0].includes(ita)){
                            if(i > 1){
                                result += ', ';
                            }
                        }
                        else if(i > 0){
                            result += ', ';
                        }
                        result += ita_list[i];
                    }
                }
                if(result == ''){
                    popup.innerHTML = '&emsp;&emsp;&nbsp;&nbsp;"Abflughafen"';
                    document.getElementById('airports').value = '';
                }else {
                    popup.innerHTML = result;
                    document.getElementById('airports').value = result;
                }
            }else {
                //adds the airport at the end
                popup.innerHTML += ', ' + ita;
                document.getElementById('airports').value += ', ' + ita;
            }
        }
    }

    </script>
</body>
</html>