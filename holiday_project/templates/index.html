{% load static from static %}
<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="author" content="Philip Steinwald">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Search Page</title>
    <link rel="shortcut icon" href="{% static 'icon.png'%}" type="image/x-icon" />
    <link rel="stylesheet" href="{% static 'style_index.css'%}" type="text/css">
</head>

<body>
    <div class="grid-container1">
        <div class="header">
            <h1>Buchen Sie jetzt ihren Urlaub!</h1>
        </div>
        <div class="right">
            <img src="{% static 'beach.png'%}" alt="Beach Pictures">
        </div>
        <div class="main">
            <form class="grid-container2" action="/response" method="get">
                <div class="destination1">
                    <label class="textVon">Von: &emsp; </label>
                    <label class="popupAirport" id="popupAirport" onclick="popupFuncAirport()">&emsp;&emsp;&nbsp;&nbsp;"Abflughafen"
                    </label>
                </div>
                <label class="destination2">Nach: &emsp; Mallorca</label>
                <label class="popup" id="popup" onclick="popupFunc()">1 Erw. 0 Kin.
                </label>
                <div class="days">
                    <label>Dauer: &nbsp;</label>
                    <input type="number" class="daysInput" id="quantity" name="quantity" min="1" required>
                    <label>Tage</label>
                </div>
                <div class="timespan">
                    <input type="date" class="dateInput" id="firstDate" name="firstDate" placeholder="Hinflug" required>
                    <label>&nbsp; bis &nbsp;</label>
                    <input type="date" class="dateInput" id="secondDate" name="secondDate" placeholder="Rückflug" required>
                </div>
                <div class="next">
                    <input type="text" class="hidden-inputs" id="airports" name="airports" value="" required>
                    <input type="text" class="hidden-inputs" id="persons" name="persons" value="1 Erw. 0 Kin." required>
                    <input type="submit" class="submitInput" value="Reise finden">
                </div>
            </form> 
        </div>
    </div>

    <div class="popup-container" id="myPopup">
        <input type="button" class="parent-minus" onclick="decrementParentValue()" value="-" />
        <input type="text" id="parent-number" class="parent-number" value="1" readonly/>
        <input type="button" class="parent-plus" onclick="incrementParentValue()" value="+" />
        <label class="parents">Erwachsene</label>
        <input type="button" class="children-minus" onclick="decrementChildrenValue()" value="-" />
        <input type="text" id="children-number" class="children-number" value="0" readonly/>
        <input type="button" class="children-plus" onclick="incrementChildrenValue()" value="+" />
        <label class="children">Kinder</label>
        <input type="button" class="popup-button" onclick="safePopup()" value="Übernehmen"/>
    </div>

    <div class="popupAirport-container" id="myAirportPopupTop" style="visibility: hidden;">
        <input type="checkbox" onclick="tickBox('FRA')"/>
        <label>Frankfurt(FRA)</label><br>
        <input type="checkbox" onclick="tickBox('MUC')"/>
        <label>München(MUC)</label><br>
        <input type="checkbox" onclick="tickBox('BER')"/>
        <label>Berlin(BER)</label><br>
        <input type="checkbox" onclick="tickBox('LEJ')"/>
        <label>Leipzig(LEJ)</label><br>
        <input type="checkbox" onclick="tickBox('DUS')"/>
        <label>Düsseldorf(DUS)</label><br>
        <input type="checkbox" onclick="tickBox('HAM')"/>
        <label>Hamburg(HAM)</label><br>
        <input type="checkbox" onclick="tickBox('VIE')"/>
        <label>Wien(VIE)</label><br>
        <input type="checkbox" onclick="tickBox('NUE')"/>
        <label>Nürnberg(NUE)</label><br>
        <input type="checkbox" onclick="tickBox('SCN')"/>
        <label>Saarbrücken(SCN)</label><br>
        <input type="checkbox" onclick="tickBox('STR')"/>
        <label>Stuttgart(STR)</label><br>
        <input type="checkbox" onclick="tickBox('HAJ')"/>
        <label>Hannover(HAJ)</label><br>
        <input type="checkbox" onclick="tickBox('BSL')"/>
        <label>Basel(BSL)</label><br>
        <input type="checkbox" onclick="tickBox('FDH')"/>
        <label>Friedrichshafen(FDH)</label><br>
        <input type="checkbox" onclick="tickBox('FMO')"/>
        <label>Münster/Osnabrück(FMO)</label><br>
        <input type="checkbox" onclick="tickBox('CGN')"/>
        <label>Köln/Bonn(CGN)</label><br>
        <input type="checkbox" onclick="tickBox('PAD')"/>
        <label>Paderborn(PAD)</label><br>
        <input type="checkbox" onclick="tickBox('FMM')"/>
        <label>Memmingen(FMM)</label><br>
        <input type="checkbox" onclick="tickBox('DRS')"/>
        <label>Dresden(DRS)</label><br>
        <input type="checkbox" onclick="tickBox('BRE')"/>
        <label>Bremen(BRE)</label><br>
        <input type="checkbox" onclick="tickBox('DTM')"/>
        <label>Dortmund(DTM)</label><br>
        <input type="checkbox" onclick="tickBox('NRN')"/>
        <label>Niederrhein(NRN)</label><br>
        <input type="checkbox" onclick="tickBox('HHN')"/>
        <label>Frankfurt-Hain(HHN)</label><br>
        <input type="checkbox" onclick="tickBox('FKB')"/>
        <label>Karlsruhe/Baden-Baden(FKB)</label><br>
        <input type="checkbox" onclick="tickBox('ZRH')"/>
        <label>Zürich(ZRH)</label><br>
        <input type="checkbox" onclick="tickBox('SZG')"/>
        <label>Salzburg(SZG)</label><br>
        <input type="checkbox" onclick="tickBox('LUX')"/>
        <label>Luxemburg(LUX)</label><br>
        <input type="checkbox" onclick="tickBox('AMS')"/>
        <label>Amsterdam(AMS)</label><br>
        <input type="checkbox" onclick="tickBox('PRG')"/>
        <label>Prag(PRG)</label><br>
        <input type="checkbox" onclick="tickBox('INN')"/>
        <label>Innsbruck(INN)</label><br>
        <input type="checkbox" onclick="tickBox('KSF')"/>
        <label>Kassel(KSF)</label><br>
        <input type="checkbox" onclick="tickBox('LNZ')"/>
        <label>Linz(LNZ)</label><br>
        <input type="checkbox" onclick="tickBox('EIN')"/>
        <label>Eindhoven(EIN)</label><br>
        <input type="checkbox" onclick="tickBox('SXB')"/>
        <label>Straßburg(SXB)</label><br>
        <input type="checkbox" onclick="tickBox('BLL')"/>
        <label>Billund(BLL)</label><br>
        <input type="checkbox" onclick="tickBox('LBC')"/>
        <label>Lübeck(LBC)</label><br>
        <input type="checkbox" onclick="tickBox('BRU')"/>
        <label>Brüssel(BRU)</label><br>
        <input type="checkbox" onclick="tickBox('GRZ')"/>
        <label>Graz(GRZ)</label><br>
        <input type="checkbox" onclick="tickBox('GWT')"/>
        <label>Sylt(GWT)</label><br>
        <input type="checkbox" onclick="tickBox('CRL')"/>
        <label>Brüssel-Süd(CRL)</label><br>
        <input type="checkbox" onclick="tickBox('CSO')"/>
        <label>Madgeburg(CSO)</label><br>
        <input type="checkbox" onclick="tickBox('WAW')"/>
        <label>Warschau(WAW)</label><br>
        <input type="checkbox" onclick="tickBox('GVA')"/>
        <label>Genf(GVA)</label><br>
        <input type="checkbox" onclick="tickBox('ERF')"/>
        <label>Erfurt-Weimar(ERF)</label><br>
        <input type="checkbox" onclick="tickBox('KRK')"/>
        <label>Krakau(KRK)</label><br>
        <input type="checkbox" onclick="tickBox('BRN')"/>
        <label>Bern(BRN)</label><br>
        <input type="checkbox" onclick="tickBox('RLG')"/>
        <label>Rostock(RLG)</label><br>
        <input type="checkbox" onclick="tickBox('KLU')"/>
        <label>Klagenfurt(KLU)</label><br>
        <input type="checkbox" onclick="tickBox('RTM')"/>
        <label>Rotterdam/Den Haag(RTM)</label><br>
    </div>

    <div class="popupAirport-button" id="myAirportPopupBottom" style="visibility: hidden;">
        <input type="button" style="width: 255px; height: 30px;" onclick="popupFuncAirport()" value="Übernehmen"/>
    </div>

    <script>

    function popupFunc() {
        var popup = document.getElementById("myPopup");
        var popupOrigin = document.getElementById("popup");
        var rect = popupOrigin.getBoundingClientRect();
        popup.style.top = (rect.top + 38)  + 'px';
        popup.style.left = (rect.left - 50) + 'px';
        popup.classList.toggle("show");
    }

    function decrementParentValue() {
        var valueC = parseInt(document.getElementById('children-number').value, 10);
        var valueP = parseInt(document.getElementById('parent-number').value, 10);
        value = (isNaN(valueC) ? 0 : valueC) + (isNaN(valueP) ? 0 : valueP);
        if(value > 1 && valueP > 0){
            valueP--;
        }
        document.getElementById('parent-number').value = valueP;
    }

    function incrementParentValue() {
        var value = parseInt(document.getElementById('parent-number').value, 10);
        value = isNaN(value) ? 0 : value;
        value++;
        document.getElementById('parent-number').value = value;
    }

    function decrementChildrenValue() {
        var valueC = parseInt(document.getElementById('children-number').value, 10);
        var valueP = parseInt(document.getElementById('parent-number').value, 10);
        value = (isNaN(valueC) ? 0 : valueC) + (isNaN(valueP) ? 0 : valueP);
        if(value > 1 && valueC > 0){
            valueC--;
        }
        document.getElementById('children-number').value = valueC;
    }

    function incrementChildrenValue() {
        var value = parseInt(document.getElementById('children-number').value, 10);
        value = isNaN(value) ? 0 : value;
        value++;
        document.getElementById('children-number').value = value;
    }

    function safePopup() {
        var value1 = parseInt(document.getElementById('parent-number').value, 10);
        var value2 = parseInt(document.getElementById('children-number').value, 10);
        document.getElementById('popup').innerHTML = value1 + ' Erw. ' + value2 + ' Kin.';
        document.getElementById('persons').value = value1 + ' Erw. ' + value2 + ' Kin.';
        popupFunc();
    }


    function popupFuncAirport() {
        var popup1 = document.getElementById("myAirportPopupTop");
        var popup2 = document.getElementById("myAirportPopupBottom");
        var popupOrigin = document.getElementById("popupAirport");
        var rect = popupOrigin.getBoundingClientRect();
        popup1.style.top = (rect.top + 38) + 'px';
        popup1.style.left = (rect.left - 5) + 'px';
        popup2.style.top = (rect.top + 138) + 'px';
        popup2.style.left = (rect.left - 5) + 'px';
        if(popup1.style.visibility == 'hidden') {
            popup1.style.visibility = 'visible';
            popup2.style.visibility = 'visible';
        }else {
            popup1.style.visibility = 'hidden';
            popup2.style.visibility = 'hidden';
        }
    }

    function tickBox(ita) {
        var popup = document.getElementById("popupAirport");
        if(popup.innerHTML.includes("Abflughafen")) {
            popup.innerHTML = ita;
            document.getElementById('airports').value = ita;
        }else {
            if(popup.innerHTML.includes(ita)){
                var ita_list = popup.innerHTML.split(', ');
                var result = '';
                for(var i=0;i<ita_list.length;i++){
                    if(!ita_list[i].includes(ita)){
                        if(i > 0 && !ita_list[0].includes(ita)){
                            result += ', ';
                        }
                        result += ita_list[i];
                    }
                }
                if(result == ''){
                    popup.innerHTML = '&emsp;&emsp;&nbsp;&nbsp;"Abflughafen"';
                    document.getElementById('airports').value = '';
                }else {
                    popup.innerHTML = result;
                    document.getElementById('airports').value = result;
                }
            }else {
                popup.innerHTML += ', ' + ita;
                document.getElementById('airports').value += ', ' + ita;
            }
        }
    }

    </script>
</body>
</html>